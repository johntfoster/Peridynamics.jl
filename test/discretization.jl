using Test
using Peridynamics.Discretization

@testset "tensor product grid" begin
    @test create_grid([0; 2], [2]) == [0.0, 2.0]
    @test create_grid([0; 2], [2]) == [0.0, 2.0]
    @test create_grid([0; 2], [3]) == [0.0, 1.0, 2.0]
    @test create_grid([0; 2], [2.0]) == [0.0, 2.0]
    @test create_grid([0; 2], [1.0]) == [0.0, 1.0, 2.0]
    @test create_grid([0; 2]) == [0.0, 1.0, 2.0]
    @test create_grid([0 0; 2 2], [2 2]) == [0.0 0.0; 0.0 2.0; 2.0 0.0; 2.0 2.0]
    @test create_grid([0 0; 1 1]) == [0.0 0.0; 0.0 1.0; 1.0 0.0; 1.0 1.0]
    @test create_grid([0 0; 2 2], [2 3]) == [0.0 0.0; 0.0 1.0; 0.0 2.0; 2.0 0.0; 2.0 1.0; 2.0 2.0]
    @test create_grid([0 0; 2 2], [2.0 2.0]) == [0.0 0.0; 0.0 2.0; 2.0 0.0; 2.0 2.0]
    @test create_grid([0 0; 2 2], [2.0 1.0]) == [0.0 0.0; 0.0 1.0; 0.0 2.0; 2.0 0.0; 2.0 1.0; 2.0 2.0]
    @test create_grid([0 0 0; 2 2 2], [2 2 2]) == [0.0 0.0 0.0; 0.0 0.0 2.0; 0.0 2.0 0.0; 0.0 2.0 2.0; 2.0 0.0 0.0; 2.0 0.0 2.0; 2.0 2.0 0.0; 2.0 2.0 2.0]
    @test create_grid([0 0 0; 1 1 1]) == [0.0 0.0 0.0; 0.0 0.0 1.0; 0.0 1.0 0.0; 0.0 1.0 1.0; 1.0 0.0 0.0; 1.0 0.0 1.0; 1.0 1.0 0.0; 1.0 1.0 1.0]
    create_grid([0 0 0; 2 2 2], [2 2 2])
    @test create_grid([0 0 0; 2 2 2], [2 2 3]) == [0.0 0.0 0.0; 0.0 0.0 1.0; 0.0 0.0 2.0; 0.0 2.0 0.0; 0.0 2.0 1.0; 0.0 2.0 2.0; 2.0 0.0 0.0; 2.0 0.0 1.0; 2.0 0.0 2.0; 2.0 2.0 0.0; 2.0 2.0 1.0; 2.0 2.0 2.0]
    @test create_grid([0 0 0; 2 2 2], [2.0 2.0 2.0]) == [0.0 0.0 0.0; 0.0 0.0 2.0; 0.0 2.0 0.0; 0.0 2.0 2.0; 2.0 0.0 0.0; 2.0 0.0 2.0; 2.0 2.0 0.0; 2.0 2.0 2.0]
    @test create_grid([0 0 0; 2 2 2], [2.0 2.0 1.0]) == [0.0 0.0 0.0; 0.0 0.0 1.0; 0.0 0.0 2.0; 0.0 2.0 0.0; 0.0 2.0 1.0; 0.0 2.0 2.0; 2.0 0.0 0.0; 2.0 0.0 1.0; 2.0 0.0 2.0; 2.0 2.0 0.0; 2.0 2.0 1.0; 2.0 2.0 2.0]
    @test_throws ArgumentError create_grid([0; 2], [2 2])
    @test_throws ArgumentError create_grid([0 0 0 0; 2 2 2 2])
    @test_throws ArgumentError create_grid([0 0 0; 2 2 2], [2 2])
    @test_throws ArgumentError create_grid([0 0; 2 2], [2 2 2])
    @test_throws ArgumentError create_grid([0 0 0 0; 2 2 2 2], [2 2 2 2])
end
